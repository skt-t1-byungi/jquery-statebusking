!function(n,t){"object"==typeof module&&module.exports?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(n.jQuery||n.$)}(window||this,function(c){var $=c.statebus,r=$.stores={},h=$.views={},u=[];$.store=function(e,n,t){r[e]=o(r,n,t);return a(function(n,t){return $.createStore(e,n,t)},e)},$.createStore=function(n,t,e){return e=e||{},-1===u.indexOf(t)&&u.push(t),p($(t,v(r,n),!0),e)};var i={$:function(n){return this.$el.find(n)},getState:function(n,t,e){return y(f(n,"state"),t,e)},getPrevState:function(n,t,e){return y(f(n,"prevState"),t,e)},dispatch:function(){var r=c.makeArray(arguments),i=r.shift(),u=[];return c.each(this.$$$subs,function(n,t){var e=t.action;-1===u.indexOf(e)&&(u.push(e),e[i]&&e[i].apply(null,r))}),this},dispatchAll:function(){var r=c.makeArray(arguments),i=r.shift();return c.each(u,function(n,t){var e=$.action[t];e&&e[i]&&e[i].apply(null,r)}),this},listenTo:function(n,t,e,r){var i,u;"string"==typeof n?(t=n+"."+t,i=$.action[n],u=$.on):(i=n.action,u=n.on);var o=u(t,c.proxy(e,this),r),a={off:o,action:i};this.$$$subs.push(a);var f=this;return function(){var n=f.$$$subs;n.splice(n.indexOf(a),1),o()}},remove:function(){return this.$el.remove(),$.remove(this.$$$ns),c.each(this.$$$subs,function(n,t){t.off()}),this.$$$subs=[],this}};function p(n,t){return n.init&&n.init(t),n}function o(t,n,e){return e||(e=n,n=[]),n=c.map([].concat(n),function(n){return v(t,n)}),c.extend.apply(null,[!0,{}].concat(n,e))}function v(n,t){var e="string"==typeof t?n[t]:t&&t.$$$name?n[t.$$$name]:t;if(e)return e;throw new TypeError('[statebusking] Unknown definition. ("'+t+'")')}function a(n,t){return c.extend(n,{$$$name:t})}$.view=function(t,n,e){h[t]=c.extend({},i,o(h,n,e));return a(function(n){return $.createView(t,n)},t)},$.createView=function(n,t){t=t||{};var e=function r(t){return"__views__/"+t+"@"+l++}(n),i=$(e,v(h,n),!0),u=d(i,"el",t);u||(u=document.createElement(d(i,"tagName",t)||"div")),u.jquery&&(u=u.get(0));var o=i.$el=c(u).eq(0),a=d(i,"attrs",t);a&&o.attr(a);var f=d(i,"events",t);if(f){var s=/^(\S+)\s*(.*)$/;c.each(f,function(n,t){"string"==typeof t&&(t=y(i,t,c.noop));var e=n.match(s);o.on(e[1],e[2],c.proxy(t,i))})}return i.$$$subs=[],i.$$$ns=e,p(i,t)};var l=0;function d(n,t,e){return e.hasOwnProperty(t)?e[t]:"function"==typeof n[t]?n[t](e):n[t]}function f(n,t){return"string"==typeof n?$[t][n]:n[t]}function y(n,t,e){for(t=t.split(".");t.length;)if((n=n[t.shift()])===undefined)return e;return n}});