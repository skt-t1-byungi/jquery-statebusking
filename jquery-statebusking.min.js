!function(t,e){"object"==typeof module&&module.exports?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery||t.$)}(window||this,function(c){var a=c.statebus,r=a.stores={},f=a.views={},i={};a.store=function(n,t,e){r[n]=u(r,t,e);return s(function(t,e){return a.createStore(n,t,e)},n)},a.createStore=function(t,e,n){return n=n||{},p(i[e]=a(e,$(r,t),n.override),n)};var o={$:function(t){return this.$el.find(t)},getStore:function(t){return"string"==typeof t?i[t]:t},getState:function(t,e){return function(t,e,n){e=e.split(".");for(;e.length;)if(!(t=t[e.shift()]))return n;return t}(this.getStore(t).state,e)},dispatch:function(){var r=c.makeArray(arguments),i=r.shift(),o=[];return c.each(this.$$$subscriptions,function(t,e){var n=e.store;-1===o.indexOf(n)&&(o.push(n),n.action[i]&&n.action[i].apply(null,r))}),this},dispatchAll:function(){var t=c.makeArray(arguments),e=t.shift();for(var n in i){var r=i[n];r.action[e]&&r.action[e].apply(null,t)}return this},listenTo:function(t,e,n,r){var i=(t=this.getStore(t)).on(e,c.proxy(n,this),r);return this.$$$subscriptions.push({unsubscribe:i,store:t}),i},remove:function(){return this.$el.remove(),c.each(this.$$$subscriptions,function(t,e){e.unsubscribe()}),this}};function p(t,e){return t.state="function"==typeof t.state?t.state(e):t.state,t.init&&t.init(e),t}function u(e,t,n){return n||(n=t,t=[]),t=c.map([].concat(t),function(t){return $(e,t)}),c.extend.apply(null,[!0,{}].concat(t,n))}function $(t,e){return"string"==typeof e?t[e]:e&&e.$$$defName?t[e.$$$defName]:e}function s(t,e){return c.extend(t,{$$$def:e})}a.view=function(e,t,n){f[e]=c.extend({},o,u(f,t,n));return s(function(t){return a.createView(e,t)},e)},a.createView=function(t,e){e=e||{};var r=a("__views__/"+t+"@"+h++,$(f,t),e.override),n=v(r,"el",e);n||(n=document.createElement(v(r,"tagName",e)||"div")),n.jquery&&(n=n.get(0));var i=r.$el=c(n).eq(0),o=v(r,"attrs",e);o&&i.attr(o);var u=v(r,"events",e);if(u){var s=/^(\S+)\s*(.*)$/;c.each(u,function(t,e){"string"==typeof e&&(e=r[e]);var n=t.match(s);i.on(n[1],n[2],c.proxy(e,r))})}return r.$$$subscriptions=[],p(r,e)};var h=0;function v(t,e,n){return"function"==typeof t[e]?t[e](n):n.hasOwnProperty(e)?n[e]:t[e]}});